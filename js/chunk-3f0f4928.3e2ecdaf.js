(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f0f4928"],{"09ca":function(t,e,s){},"36dd":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("lock-scroll",{attrs:{locked:t.lockScroll}},[e("lock-screen",{attrs:{locked:t.lockScreen}}),e("app-layout",[e("div",{staticClass:"flex flex-col items-center py-4",class:{"cursor-not-allowed":t.disabled}},[e("div",{staticClass:"w-full lg:w-4/5 px-4"},[e("div",{staticClass:"text-center"},[e("span",{staticClass:"text-xl font-bold text-gray-500"},[t._v(" "+t._s(t.today)+" ")])]),e("div",{staticClass:"text-center py-2"},[e("span",{staticClass:"text-xl font-bold text-gray-500"},[t._v(" Saludos, "+t._s(t.fullname)+" ")])]),e("div",{staticClass:"flex flex-col lg:flex-row py-2 lg:space-x-2"},[e("card-button",{staticClass:"w-full align-middle text-center lg:w-1/3 mb-2",attrs:{disabled:t.disabled,name:"orders.index",params:{status:""+t.OrderStatusEnum.PendingAssignment}}},[e("i",{staticClass:"text-3xl bx bx-group align-bottom text-purple-500"}),e("span",{staticClass:"text-xl font-bold ml-2"},[t._v(t._s(t.counts.pendingAssignment))]),e("span",{staticClass:"text-xl font-bold ml-2"},[t._v("Por Asignar")])]),e("card-button",{staticClass:"w-full align-middle justify-center text-center lg:w-1/3 mb-2",attrs:{disabled:t.disabled,name:"orders.index",params:{status:""+t.OrderStatusEnum.InProgress}}},[e("i",{staticClass:"text-3xl bx bx-timer align-bottom text-purple-500"}),e("span",{staticClass:"text-xl font-bold ml-2"},[t._v(t._s(t.counts.inProgress))]),e("span",{staticClass:"text-xl font-bold ml-2"},[t._v("En Proceso")])]),e("card-button",{staticClass:"w-full align-middle justify-center text-center lg:w-1/3 mb-2",attrs:{disabled:t.disabled,name:"orders.index",params:{status:""+t.OrderStatusEnum.ToBeDelivered}}},[e("i",{staticClass:"text-3xl bx bx-package align-bottom text-purple-500"}),e("span",{staticClass:"text-xl font-bold ml-2"},[t._v(t._s(t.counts.toBeDelivered))]),e("span",{staticClass:"text-xl font-bold ml-2"},[t._v("Por Entregar")])])],1),e("div",{staticClass:"w-full flex flex-col lg:flex-row space-y-6"},[e("div",{staticClass:"w-full lg:w-1/2"},[e("chart",{attrs:{options:t.chartOptions}})],1),e("div",{staticClass:"w-full lg:w-1/2",staticStyle:{"align-self":"center"}},[e("div",{staticClass:"w-full flex flex-row",staticStyle:{"justify-content":"space-around"}},[e("div",{staticClass:"text-center text-2xl"},[e("h1",[e("strong",[t._v("Ventas")])]),e("h2",[t._v(t._s(t.moneyFormat(t.totalSale)))])]),e("div",{staticClass:"text-center text-2xl"},[e("h1",[e("strong",[t._v("Finalizados")])]),e("h2",[t._v(t._s(t.counts.finalized))])])]),e("div",{staticClass:"w-full flex flex-row justify-center"},[e("div",{staticClass:"border border-purple-500 text-xl text-center cursor-pointer",class:{"bg-purple-500 text-white":1===t.active,"cursor-not-allowed":t.disabled},staticStyle:{"min-width":"100px",width:"100px"},on:{click:function(e){return t.changeActive(1)}}},[t._v(" Hoy ")]),e("div",{staticClass:"border border-purple-500 text-xl text-center cursor-pointer",class:{"bg-purple-500 text-white":2===t.active,"cursor-not-allowed":t.disabled},staticStyle:{"min-width":"100px",width:"100px"},on:{click:function(e){return t.changeActive(2)}}},[t._v(" Semana ")]),e("div",{staticClass:"border border-purple-500 text-xl text-center cursor-pointer",class:{"bg-purple-500 text-white":3===t.active,"cursor-not-allowed":t.disabled},staticStyle:{"min-width":"100px",width:"100px"},on:{click:function(e){return t.changeActive(3)}}},[t._v(" Mes ")])]),e("div",{staticClass:"w-full flex flex-row justify-center mt-4"},[e("el-button",{on:{click:t.closeDay}},[t._v(" Cerrar Dia ")])],1)])]),e("div",{staticClass:"flex flex-col space-y-6"},[e("content-card",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{title:"Ã“rdenes con fecha lÃ­mite en esta semana","with-options":""}},[e("div",{staticClass:"py-2"},[e("div",[e("orders-grid",{attrs:{hasActions:!t.disabled,orders:t.orders},on:{onStatusUpdate:t.updateStatus,onSorting:t.handleSorting}})],1)])])],1)])])]),e("el-dialog",{attrs:{visible:t.showQuickStartDialog,width:"75%"},on:{"update:visible":function(e){t.showQuickStartDialog=e},close:t.start}},[e("div",{staticClass:"text-center"},[e("div",[e("span",{staticClass:"text-5xl text-gray-500 font-bold"},[t._v("Bienvenido a Samii")])]),e("div",[e("img",{staticClass:"m-auto",attrs:{src:s("6f28"),width:"320px"}})]),e("div",[e("span",{staticClass:"text-4xl text-gray-400"},[t._v(" El primer software para tÃ©cnicos hecho por un tÃ©cnico. ")])]),e("div",{staticClass:"w-full"},[e("div",{staticClass:"text-right"},[e("el-button",{staticClass:"el-button--primary",on:{click:t.start}},[t._v("Crear mi Primer Orden")])],1)])])]),e("el-dialog",{attrs:{visible:t.paymentMethod.show,width:t.dialogClientWidth},on:{"update:visible":function(e){return t.$set(t.paymentMethod,"show",e)}}},[e("div",[e("div",{staticClass:"mb-4"},[e("span",{staticClass:"text-md font-bold break-words"},[t._v(" Por favor, selecciona un metodo de pago para finalizar la orden ")])]),e("span",[t._v("Metodo de Pago")]),e("el-select",{staticClass:"w-full",on:{change:t.paymentMethodSelect},model:{value:t.paymentMethod.value,callback:function(e){t.$set(t.paymentMethod,"value",e)},expression:"paymentMethod.value"}},t._l(t.paymentMethods,(function(s){return e("el-option",{key:s.id,attrs:{label:s.name,value:s.id}},[e("div",{staticClass:"flex flex-row items-center"},[e("span",{staticClass:"ml-2"},[t._v(" "+t._s(s.name)+" ")])])])})),1)],1)])],1)},i=[],r=(s("14d9"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"px-4 py-4 bg-white border border-purple-500 rounded-2xl shadow cursor-pointer transition duration-300 ease-in-out transform hover:-translate-y-1 hover:bg-gray-200",class:{disabled:t.disabled},on:{click:t.handleClick}},[e("div",[t._t("default")],2)])}),o=[],l={name:"CardButton",props:{title:{type:String,default:()=>null},name:{type:String,default:()=>null},params:{type:Object,default:()=>null},disabled:{type:Boolean,default:()=>!1}},methods:{handleClick(){this.disabled||this.$router.push({name:this.name,params:this.params})}}},n=l,d=(s("932a"),s("2877")),c=Object(d["a"])(n,r,o,!1,null,"25eeaba0",null),u=c.exports,p=s("5a50"),h=s("c177"),m=s("7dab");class f{static async Dashboard(t){var e;const s=await h["a"].submit({method:"get",url:"Orders/Dashboard",parameters:t});return await m["a"].get(),null!==(e=null===s||void 0===s?void 0:s.data)&&void 0!==e?e:null}}var x=s("cfd9"),b=s("d7ee3"),v=s("4452"),g=s("1268"),w=s("0517"),y=s("4cf1"),C={name:"HomeIndex",mixins:[w["a"]],components:{OrdersGrid:b["a"],AppLayout:()=>s.e("chunk-2b774e2e").then(s.bind(null,"c987")),ContentCard:()=>Promise.resolve().then(s.bind(null,"3246")),CardButton:u,Chart:v["Chart"]},data(){return{loading:!1,active:1,orders:[],filters:{dueDateEnd:this.$moment(new Date).format("MM/DD/YYYY"),dueDateStart:this.$moment(new Date).format("MM/DD/YYYY")},totalSale:0,counts:{finalized:0,inProgress:0,pendingAssignment:0,toBeDelivered:0},OrderStatusEnum:p["k"],chartOptions:{colors:["#FCA5A5","#6EE7B7","#A5B4FC"],credits:{enabled:!1},chart:{type:"pie",options3d:{enabled:!1,alpha:45},margin:[0,0,0,15],spacingTop:0,spacingBottom:0,spacingLeft:0,spacingRight:0},title:{text:null},plotOptions:{pie:{innerSize:100,depth:10}},series:[{name:"Estado",data:[["Por Asignar",0],["En Proceso",0],["Por Entregar",0]]}]},lockScroll:!1,lockScreen:!1,showQuickStartDialog:!1,paymentMethod:{show:!1,orderId:null,status:null,value:null},paymentMethods:[],dialogClientWidth:"30%"}},computed:{today(){return this.$moment(new Date).format("MM/DD/YYYY")},fullname(){return this.$store.state.account.fullname},disabled(){return this.$store.state.account.membershipLimitReached}},mounted(){const t=localStorage.getItem("samii-invoices-logo-size");t||localStorage.setItem("samii-invoices-logo-size",JSON.stringify({width:"100px !important",height:"100px !important"}));const e=localStorage.getItem("samii-quick-start");e&&"done"!==e?(this.showQuickStartDialog=!0,this.lockScreen=!0):this.load()},methods:{async updateFilters(){const t=new Date,e=new Date;if(1===this.active&&(this.filters.dueDateStart=this.$moment(t).format("MM/DD/YYYY"),this.filters.dueDateEnd=this.$moment(e).format("MM/DD/YYYY")),2===this.active){const s=t.getDate()-t.getDay(),a=s+6;this.filters.dueDateStart=this.$moment(new Date(t.setDate(s))).format("MM/DD/YYYY"),this.filters.dueDateEnd=this.$moment(new Date(e.setDate(a))).format("MM/DD/YYYY")}if(3===this.active){const e=t.getMonth(),s=t.getFullYear();this.filters.dueDateStart=this.$moment(new Date(s,e,1)).format("MM/DD/YYYY"),this.filters.dueDateEnd=this.$moment(new Date(s,e+1,0)).format("MM/DD/YYYY")}},async changeActive(t){this.disabled||(this.active=t,await this.updateFilters(),await this.load())},async load(){try{const t=await f.Dashboard(this.filters);this.orders=t.orders.sort((t,e)=>new Date(e.createdAt)-new Date(t.createdAt)),this.totalSale=t.totalSales,this.counts=t.totalsAmount,this.chartOptions.series=[{name:"Estado",data:[["Por Asignar",this.counts.pendingAssignment],["En Proceso",this.counts.inProgress],["Por Entregar",this.counts.toBeDelivered]]}];const e=await this.$store.state.business;e.timezone||this.$swal.fire({title:"Falta InformaciÃ³n en tu Perfil",icon:"info",text:"Ahora puedes indicar la zona horaria en la que te encuentras. Puedes modificarlo desde tu perfil.",confirmButtonText:'<i class="fa fa-thumbs-up"></i> OK'}).then(()=>{this.$router.push({name:"admin.index",params:{slot:"my-business"}})}),this.paymentMethods=await x["a"].getPaymentMethods()}catch(t){this.$toastr.e(this.getErrorMessage(t))}},async updateOrderStatus(t,e,s){await x["a"].updateStatus({id:t,status:e,paymentMethod:s}),this.$toastr.s("Se actualizo con exito"),await this.load()},paymentMethodSelect(){this.updateOrderStatus(this.paymentMethod.orderId,this.paymentMethod.status,this.paymentMethod.value),this.paymentMethod={show:!1,orderId:null,status:null,value:null}},updateStatus({orderId:t,status:e}){this.loading=!0;try{const{value:s}=this.$store.state.catalogs.statuses[p["k"].Finalized];e===s?(this.paymentMethod={show:!0,orderId:t,status:e,value:null},this.resizeDialogWidth()):this.updateOrderStatus(t,e)}catch(s){this.$toastr.e(this.getErrorMessage(s))}finally{this.loading=!1}},moneyFormat(t){const{currencySymbol:e}=this.$store.state.account;return g["a"].moneyFormat(t,e)},handleSorting(t){const e=Object.keys(t),s=t[e];this.orders=this.orders.sort((t,e)=>"desc"===s?new Date(e.createdAt)-new Date(t.createdAt):new Date(t.createdAt)-new Date(e.createdAt))},start(){this.showQuickStartDialog=!1,this.$store.dispatch(y["b"],{step:1})},closeDay(){this.$router.push({name:"close.day"})},resizeDialogWidth(){this.dialogClientWidth=this.getPercentageWidth()}}},D=C,S=Object(d["a"])(D,a,i,!1,null,null,null);e["default"]=S.exports},"6f28":function(t,e,s){t.exports=s.p+"img/welcome-samii.2ffda953.png"},"932a":function(t,e,s){"use strict";s("09ca")},d7ee3:function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"block w-full overflow-x-auto"},[e("table",{staticClass:"items-center w-full border-collapse"},[e("thead",[e("tr",{staticClass:"px-2 border-b-2"},[t.hasActions?e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"}):t._e(),e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"},[t._v(" Orden ")]),e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"},[e("div",{staticClass:"w-full flex flex-row"},[e("span",[t._v("Fecha")]),e("div",{staticClass:"mx-2 font-normal cursor-pointer",on:{click:function(e){return t.sort("createdDate")}}},["desc"===t.sorting.createdDate?e("i",{staticClass:"text-lg bx bx-sort-down text-purple-500"}):t._e(),"asc"===t.sorting.createdDate?e("i",{staticClass:"text-lg bx bx-sort-up text-purple-500"}):t._e()])])]),e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"},[t._v(" Cliente ")]),e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"},[t._v(" Asignado a ")]),e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"},[t._v(" Modelo ")]),e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"},[t._v(" Status ")]),e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"},[t._v(" Prioridad ")]),e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"},[t._v(" Fecha compromiso ")]),e("th",{staticClass:"py-3 font-bold text-left border-l-0 border-r-0 whitespace-nowrap"},[t._v(" Total ")])])]),e("tbody",t._l(t.orders,(function(s){var a,i;return e("tr",{key:s.id},[t.hasActions||t.store.state.account.canEditOrders?t._e():e("td",{staticClass:"p-2 border-t",staticStyle:{"min-width":"50px",width:"50px"}}),t.hasActions&&t.$store.state.account.canEditOrders?e("td",{staticClass:"p-2 border-t",staticStyle:{"min-width":"50px",width:"50px"}},[e("el-popover",{attrs:{placement:"right",width:"100",trigger:"hover"}},[e("div",{staticClass:"w-full flex flex-row text-center"},[e("div",{staticClass:"w-1/4"},[e("button",{staticClass:"el-button--primary rounded-full cursor-pointer",attrs:{title:"Editar"},on:{click:function(e){return t.onEdit(s)}}},[e("i",{staticClass:"bx bx-edit",staticStyle:{padding:"4px","font-size":"20px"}})])]),e("div",{staticClass:"w-1/4"},[e("button",{staticClass:"el-button--warning rounded-full cursor-pointer",attrs:{title:"Imprimir"},on:{click:function(e){return t.onPrint(s)}}},[e("i",{staticClass:"bx bx-printer",staticStyle:{padding:"4px","font-size":"20px"}})])]),e("div",{staticClass:"w-1/4"},[e("button",{staticClass:"el-button--danger rounded-full cursor-pointer",attrs:{title:"Eliminar"},on:{click:function(e){return t.onDelete(s.id)}}},[e("i",{staticClass:"bx bx-trash",staticStyle:{padding:"4px","font-size":"20px"}})])]),e("div",{staticClass:"w-1/4"},[e("button",{staticClass:"el-button--info rounded-full cursor-pointer",attrs:{title:"Notas"},on:{click:function(e){return t.showOrderNotesManager(s.id)}}},[e("i",{staticClass:"bx bx-note",staticStyle:{padding:"4px","font-size":"20px"}})])])]),e("el-button",{staticClass:"w-full",attrs:{slot:"reference",type:"text"},slot:"reference"},[e("button",{staticClass:"el-button--primary rounded-full cursor-pointer"},[e("i",{staticClass:"text-2xl bx bx-chevron-right"})])])],1)],1):t._e(),e("td",{staticClass:"p-2 border-t",staticStyle:{"min-width":"125px"}},[t._v(" "+t._s(s.reference)+" ")]),e("td",{staticClass:"p-2 border-t",staticStyle:{"min-width":"155px"}},[e("el-date-picker",{staticClass:"w-full bg-select-button",attrs:{type:"date",disabled:""},model:{value:s.createdAt,callback:function(e){t.$set(s,"createdAt",e)},expression:"order.createdAt"}})],1),e("td",{staticClass:"p-2 border-t text-left"},[t.hasActions?e("el-popover",{attrs:{placement:"bottom",width:"250",trigger:"click"}},[e("div",{staticClass:"flex flex-col"},[e("div",{staticClass:"flex flex-col py-4"},[e("span",{staticClass:"font-bold"},[t._v(t._s(s.client.fullName))]),e("span",{staticClass:"text-purple-500 underline"},[t._v(t._s(s.client.email))])]),e("div",{staticClass:"py-2 border-t"},[e("sa-button",{staticClass:"w-full",attrs:{type:"secondary"}},[t._v(" Ver cliente ")])],1)]),e("el-button",{staticClass:"text-left",attrs:{slot:"reference",type:"text"},slot:"reference"},[e("span",[t._v(t._s(s.client.fullName))]),e("i",{staticClass:"bx bx-chevron-down"})])],1):e("span",[t._v(t._s(s.client.fullName))])],1),e("td",{staticClass:"p-2 border-t text-left",staticStyle:{"min-width":"125px"}},[t._v(" "+t._s(t.getAssignedAccountName(s))+" ")]),e("td",{staticClass:"p-2 border-t text-left",staticStyle:{"min-width":"100px"}},[t._v(" "+t._s(t.getDeviceModel(s))+" ")]),e("td",{staticClass:"p-2 border-t",staticStyle:{"min-width":"160px"}},[t.hasActions?e("el-select",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{value:null===(a=s.orderStatus)||void 0===a?void 0:a.name},on:{change:function(e){return t.updateStatus(s.id,e)}}},[e("div",{staticClass:"mt-2 text-xl rounded-sm badge",style:{"background-color":null===(i=s.orderStatus)||void 0===i?void 0:i.colour},attrs:{slot:"prefix"},slot:"prefix"}),t._l(t.statuses,(function(s){return e("el-option",{key:s.value,attrs:{value:s.value,label:s.label}},[e("div",{staticStyle:{display:"inline-flex"}},[e("div",{staticClass:"mt-2 text-xl rounded-sm badge",style:{"background-color":s.color}}),e("div",[t._v(t._s(s.label))])])])}))],2):e("span",[t._v(t._s(t.OrderStatusEnumDict[s.orderStatus]))])],1),e("td",{staticClass:"p-2 border-t",staticStyle:{"min-width":"100px"}},[t._v(" "+t._s(t.priorities[s.priority])+" ")]),e("td",{staticClass:"p-2 border-t",staticStyle:{"min-width":"155px"}},[e("el-date-picker",{staticClass:"w-full bg-select-button",attrs:{type:"date",disabled:""},model:{value:s.dueDate,callback:function(e){t.$set(s,"dueDate",e)},expression:"order.dueDate"}})],1),e("td",{staticClass:"p-2 border-t",staticStyle:{"min-width":"110px"}},[t._v(" "+t._s(t.moneyFormat(s.subtotalAmount+s.taxAmount))+" ")])])})),0)])])},i=[],r=(s("14d9"),s("5a50")),o=s("1268"),l=s("ead0"),n=s("e419"),d={name:"OrdersGrid",props:{hasActions:{type:Boolean,default:()=>!0},orders:{type:Array,default:()=>[]}},data(){return{sorting:{createdDate:"desc"},loading:!1,OrderStatusEnumDict:r["l"],statuses:this.$store.state.catalogs.statuses,priorities:{[r["r"].Low]:"Baja",[r["r"].Medium]:"Media",[r["r"].High]:"Alta"}}},methods:{getDeviceModel(t){var e,s,a;return(null===(e=t.orderDevices[0])||void 0===e||null===(s=e.deviceModel)||void 0===s?void 0:s.model)||(null===(a=t.orderDevices[0])||void 0===a?void 0:a.deviceModel)||""},getAssignedAccountName(t){return t.assignedToAccount?t.assignedToAccount.fullname:""},showOrderNotesManager(t){l["a"].show(t)},async updateStatus(t,e){const s=this.orders.find(e=>e.id===t);this.whatsapp(e,s),this.$emit("onStatusUpdate",{orderId:t,status:e})},whatsapp(t,e){if(!e.client.countryCode)return void this.$toastr.e("El Cliente debe tener registrado el CÃ³digo de Area");const s=`Â¿Deseas notificar al cliente ${e.client.fullName} por WhatsApp?`,a={type:"warning",confirmButtonText:"SI",cancelButtonText:"NO"};switch(t){case this.statuses[r["k"].InProgress].value:this.$confirm(s,a).then(async()=>{Object(n["a"])({code:e.client.countryCode,phone:e.client.phone,text:`Tu orden ${e.reference} ya se estÃ¡ trabajando`})});break;case this.statuses[r["k"].ToBeDelivered].value:this.$confirm(s,a).then(async()=>{Object(n["a"])({code:e.client.countryCode,phone:e.client.phone,text:`Hola tu orden ${e.reference} estÃ¡ lista para recogerse`})});break;default:}},moneyFormat(t){const{currencySymbol:e}=this.$store.state.account;return o["a"].moneyFormat(t,e)},onEdit(t){this.$router.push({name:"orders.read",params:{id:t.id}})},onPrint(t){this.$router.push({name:"invoices.default",params:{id:t.id}})},async onDelete(t){const e=this.orders.find(e=>e.id===t);this.$confirm(`Â¿EstÃ¡ seguro que desea eliminar la orden ${e.reference}?`,{type:"warning",confirmButtonText:"OK",cancelButtonText:"Cancelar"}).then(async()=>{this.$emit("onDeleteOrder",t)})},sort(t){this.sorting[t]="asc"===this.sorting[t]?"desc":"asc",this.$emit("onSorting",this.sorting)}}},c=d,u=(s("f546"),s("2877")),p=Object(u["a"])(c,a,i,!1,null,"0b3b3374",null);e["a"]=p.exports},f2b4:function(t,e,s){},f546:function(t,e,s){"use strict";s("f2b4")}}]);
//# sourceMappingURL=chunk-3f0f4928.3e2ecdaf.js.map