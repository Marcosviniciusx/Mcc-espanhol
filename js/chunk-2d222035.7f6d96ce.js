(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d222035"],{cd97:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"flex flex-row items-center px-6 pb-4 border-b"},[e("span",{staticClass:"text-md"},[t._v("Buscar productos")]),e("a",{staticClass:"text-purple-400 ml-auto",on:{click:t.showCreateProductDialog}},[e("strong",[t._v("+ Agregar nuevo producto")])]),e("div",{staticClass:"ml-4"},[e("sa-icon-button",{attrs:{"with-bg":"",iconClass:"text-xl bx bx-x"},on:{click:t.cancel}})],1)]),e("div",{staticClass:"w-full flex flex-row px-6 py-4"},[e("el-input",{ref:"textSearch",model:{value:t.queryProducts.textSearch,callback:function(e){t.$set(t.queryProducts,"textSearch",e)},expression:"queryProducts.textSearch"}},[e("i",{staticClass:"mt-2 text-xl bx bx-search",attrs:{slot:"prefix"},slot:"prefix"})]),e("div",{staticClass:"m-1 ml-4"},[e("pagination",{attrs:{pagination:t.pagination},on:{onPaginationChange:t.onPaginationChange}})],1)],1),e("div",[0===t.filteredProducts.length?e("div",{staticClass:"py-8 text-center"},[t.queryProducts.textSearch?e("div",{staticClass:"inline-block w-full"},[e("i",{staticClass:"text-3xl bx bx-confused"}),e("div",[e("span",[t._v("No se encontraron productos que coincidan con")]),e("span",{staticClass:"mx-1 italic font-bold"},[t._v(t._s(t.textSearch))])])]):t._e()]):e("div",[e("div",{staticClass:"px-4 py-2"},[e("products-search-list",{attrs:{products:t.paginated},on:{onChangeSelectedProducts:t.onChangeSelectedProducts}})],1)])]),e("div",{staticClass:"px-6 pt-6 border-t"},[t.errorMessage?e("div",{staticClass:"py-2 text-right"},[e("span",{staticClass:"text-red-500"},[t._v(t._s(t.errorMessage))])]):t._e(),e("div",{staticClass:"flex flex-row justify-end space-x-2"},[e("sa-button",{attrs:{type:"secondary"},on:{click:t.cancel}},[t._v(" Cancelar ")]),e("sa-button",{attrs:{type:"primary"},on:{click:t.selectProducts}},[t._v(" Seleccionar ")])],1)]),e("el-dialog",{attrs:{visible:t.isVisibleCreateProductDialog,"append-to-body":"","show-close":"",width:t.dialogClientWidth},on:{"update:visible":function(e){t.isVisibleCreateProductDialog=e}}},[e("div",{staticClass:"w-full flex justify-between"},[e("span",{staticClass:"font-bold text-md"},[t._v("Crear Producto")]),e("el-button",{staticClass:"el-button--primary ml-auto",on:{click:t.createProduct}},[t._v("Guardar")])],1),e("product-form",{attrs:{loading:t.createProductLoading,form:t.createProductForm}})],1)],1)},r=[],i=(a("14d9"),a("2ef0")),o=a.n(i),c=a("0517"),n=a("8266"),d=a("73c5"),l={name:"ProductSearch",mixins:[c["a"],n["a"]],components:{ProductsSearchList:()=>a.e("chunk-2d0bd1ad").then(a.bind(null,"2b29")),Pagination:()=>a.e("chunk-2d21b32a").then(a.bind(null,"bf6f")),ProductForm:()=>a.e("chunk-72711c8d").then(a.bind(null,"6d23"))},props:{textSearch:{type:String,default:()=>null}},data(){return{errorMessage:null,filteredProducts:[],selectedProducts:[],pagination:{currentPage:1,perPage:10,totalPages:0},dialogClientWidth:"40%",createProductLoading:!1,isVisibleCreateProductDialog:!1,createProductForm:{name:void 0,description:void 0,category:void 0,brand_model:void 0,cost:void 0,price:void 0,quantity:0},queryProducts:{textSearch:null,pageSize:10,pageNumber:1}}},mounted(){this.$refs.textSearch.focus(),this.queryProducts.textSearch=this.textSearch},created(){window.addEventListener("resize",o.a.debounce(this.resizeDialogWidth,200))},destroyed(){window.removeEventListener("resize",o.a.debounce(this.resizeDialogWidth,200))},watch:{"queryProducts.textSearch":{deep:!0,handler:o.a.debounce((async function(){await this.loadProducts(this.queryProducts)}),300)}},computed:{paginated(){const t=[...this.filteredProducts],{currentPage:e,perPage:a}=this.pagination,s=[];while(t.length)s.push(t.splice(0,a));return s[e-1]}},methods:{async loadProducts(t){try{const e=await d["a"].getAll({textSearch:t.textSearch});this.filteredProducts=e,this.pagination.currentPage=1,this.pagination.totalPages=Math.ceil(this.filteredProducts.length/this.pagination.perPage)||1}catch{this.$message.error(this.getErrorMessage(c["a"]))}},cancel(){this.$emit("cancel")},selectProducts(){0!==this.selectedProducts.length?this.$emit("onSelectProducts",this.selectedProducts):this.errorMessage="Seleccione uno o mÃ¡s productos para continuar"},onChangeSelectedProducts(t){this.selectedProducts=t},onPaginationChange(t){this.pagination=t},resizeDialogWidth(){const t=this.getPercentageWidth();this.dialogClientWidth="30%"===t?"40%":t},showCreateProductDialog(){this.isVisibleCreateProductDialog=!0,this.resizeDialogWidth()},async createProduct(){this.createProductLoading=!0;try{const t={name:this.createProductForm.name,description:this.createProductForm.description,category:this.createProductForm.category,brandModel:this.createProductForm.brand_model,cost:parseFloat(this.createProductForm.cost),price:parseFloat(this.createProductForm.price),quantity:parseFloat(this.createProductForm.quantity)};await d["a"].create({product:t}),await this.$toastr.s("Se creo con exito")}catch(c){this.$toastr.e(this.getErrorMessage(c))}finally{this.createProductLoading=!1,this.isVisibleCreateProductDialog=!1}}}},u=l,h=a("2877"),p=Object(h["a"])(u,s,r,!1,null,null,null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d222035.7f6d96ce.js.map