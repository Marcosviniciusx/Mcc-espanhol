(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-575ddda8"],{"421c":function(e,i,s){"use strict";s.r(i);var t=function(){var e=this,i=e._self._c;return i("div",{staticClass:"flex flex-col items-center py-4"},[i("div",{staticClass:"w-full lg:px-36 sm:px-8"},[e._m(0),i("div",{staticClass:"flex flex-col space-y-4"},[i("content-card",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.sendingInvitation,expression:"sendingInvitation",modifiers:{fullscreen:!0,lock:!0}}]},[i("div",{staticClass:"w-full py-4"},[i("div",{staticClass:"w-full px-4 lg:px-8 space-y-2 text-center"},[i("strong",[e._v("Enviar invitaciÃ³n por correo")]),i("div",{staticClass:"flex"},[i("el-input",{model:{value:e.email,callback:function(i){e.email=i},expression:"email"}}),i("div",{staticClass:"ml-4"},[i("el-button",{on:{click:e.sendInvite}},[e._v("Enviar")])],1)],1),i("div",{staticClass:"flex mt-2"},[i("el-radio-group",{model:{value:e.accountType,callback:function(i){e.accountType=i},expression:"accountType"}},[i("el-radio",{attrs:{label:e.AccountTypeEnum.Technical}},[e._v("TÃ©cnico")]),i("el-radio",{attrs:{label:e.AccountTypeEnum.Biller}},[e._v("Recepcionista")])],1)],1)])])]),i("content-card",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.changingRol||e.changingPermit,expression:"changingRol || changingPermit",modifiers:{fullscreen:!0,lock:!0}}]},[i("div",{staticClass:"w-full py-4"},[i("div",{staticClass:"w-full"},[i("div",{staticClass:"block w-full overflow-x-auto"},[i("div",{staticClass:"w-full flex flex-row border-collapse"},[i("div",{staticClass:"w-1/12 font-bold text-left"}),i("div",{staticClass:"w-6/12 font-bold text-left"},[e._v("Nombre")]),i("div",{staticClass:"w-5/12 font-bold text-left"},[e._v("Rol")])]),e._l(e.users,(function(s){return i("div",{key:s.id,staticClass:"w-full flex flex-row border-b"},[i("div",{staticClass:"w-1/12 text-left"},[i("div",{staticClass:"w-12/12 py-2 flex flex-row"},[i("i",{staticClass:"text-lg cursor-pointer bx",class:e.details[s.id]?"bx-chevron-down":"bx-chevron-right",on:{click:function(i){return e.showDetails(s.id)}}})])]),i("div",{staticClass:"w-11/12 text-left"},[i("div",{staticClass:"w-12/12 py-2 flex flex-row"},[i("div",{staticClass:"w-6/12 text-left"},[e._v(" "+e._s(s.name)+" ")]),i("div",{staticClass:"w-5/12 text-left"},[i("el-select",{attrs:{disabled:s.accountType===e.AccountTypeEnum.Owner},on:{change:function(i){return e.updateUserAccountType(s.id,i)}},model:{value:s.accountType,callback:function(i){e.$set(s,"accountType",i)},expression:"user.accountType"}},e._l(e.accountTypes,(function(e){return i("el-option",{key:e.value,attrs:{value:e.value,label:e.label,disabled:e.disabled}})})),1)],1)]),e.details[s.id]?i("div",{staticClass:"py-2"},[i("div",{staticClass:"w-full"},[i("div",{staticClass:"w-full py-1 flex flex-col lg:flex-row"},[i("div",{staticClass:"w-full lg:w-5/12"},[i("label",{class:{"cursor-pointer":!s.isOwner},attrs:{for:"permit-can-view-administration-"+s.id}},[i("i",{staticClass:"bx bx-info-circle",attrs:{title:"El usuario podrÃ¡ hacer uso de todo el panel de administrar negocio"}}),e._v(" Permiso para usar panel de administraciÃ³n ")])]),i("div",{staticClass:"w-full lg:w-1/12"},[i("el-switch",{attrs:{id:"permit-can-view-administration-"+s.id,disabled:s.isOwner},on:{change:function(i){return e.changePermit(s,"canViewAdministration")}},model:{value:s.canViewAdministration,callback:function(i){e.$set(s,"canViewAdministration",i)},expression:"user.canViewAdministration"}})],1),i("div",{staticClass:"w-full lg:w-5/12"},[i("label",{class:{"cursor-pointer":!s.isOwner},attrs:{for:"permit-can-view-branch-offices-"+s.id}},[i("i",{staticClass:"bx bx-info-circle",attrs:{title:"El usuario podrÃ¡ tener acceso a las demÃ¡s sucursales"}}),e._v(" Permiso para uso de panel de sucursales ")])]),i("div",{staticClass:"w-full lg:w-1/12"},[i("el-switch",{attrs:{id:"permit-can-view-branch-offices-"+s.id,disabled:s.isOwner},on:{change:function(i){return e.changePermit(s,"canViewBranchOffices")}},model:{value:s.canViewBranchOffices,callback:function(i){e.$set(s,"canViewBranchOffices",i)},expression:"user.canViewBranchOffices"}})],1)]),i("div",{staticClass:"w-full py-1 flex flex-col lg:flex-row"},[i("div",{staticClass:"w-full lg:w-5/12"},[i("label",{class:{"cursor-pointer":!s.isOwner},attrs:{for:"permit-can-view-statistics-"+s.id}},[i("i",{staticClass:"bx bx-info-circle",attrs:{title:"El usuario podrÃ¡ ver las estadÃ­sticas del negocio"}}),e._v(" Permiso para usar panel de estadÃ­sticas ")])]),i("div",{staticClass:"w-full lg:w-1/12"},[i("el-switch",{attrs:{id:"permit-can-view-statistics-"+s.id,disabled:s.isOwner},on:{change:function(i){return e.changePermit(s,"canViewStatistics")}},model:{value:s.canViewStatistics,callback:function(i){e.$set(s,"canViewStatistics",i)},expression:"user.canViewStatistics"}})],1),i("div",{staticClass:"w-full lg:w-5/12"},[i("label",{class:{"cursor-pointer":!s.isOwner},attrs:{for:"permit-can-view-orders-"+s.id}},[i("i",{staticClass:"bx bx-info-circle",attrs:{title:"El usuario podrÃ¡ ver todas las ordenes, no solo las ordenes asignadas a Ã©l"}}),e._v(" Permiso para ver ordenes de todo el negocio ")])]),i("div",{staticClass:"w-full lg:w-1/12"},[i("el-switch",{attrs:{id:"permit-can-view-orders-"+s.id,disabled:s.isOwner},on:{change:function(i){return e.changePermit(s,"canViewOrders")}},model:{value:s.canViewOrders,callback:function(i){e.$set(s,"canViewOrders",i)},expression:"user.canViewOrders"}})],1)]),i("div",{staticClass:"w-full py-1 flex flex-col lg:flex-row"},[i("div",{staticClass:"w-full lg:w-5/12"},[i("label",{class:{"cursor-pointer":!s.isOwner},attrs:{for:"permit-can-edit-orders-"+s.id}},[i("i",{staticClass:"bx bx-info-circle",attrs:{title:"El usuario podrÃ¡ editar las ordenes"}}),e._v(" Permiso para modificar ordenes ")])]),i("div",{staticClass:"w-full lg:w-1/12"},[i("el-switch",{attrs:{id:"permit-can-edit-orders-"+s.id,disabled:s.isOwner},on:{change:function(i){return e.changePermit(s,"canEditOrders")}},model:{value:s.canEditOrders,callback:function(i){e.$set(s,"canEditOrders",i)},expression:"user.canEditOrders"}})],1),i("div",{staticClass:"w-full lg:w-5/12"},[i("label",{class:{"cursor-pointer":!s.isOwner},attrs:{for:"permit-can-edit-prices-"+s.id}},[i("i",{staticClass:"bx bx-info-circle",attrs:{title:"El usuario podrÃ¡ modificar los precios y costos si no solo vera precio final"}}),e._v(" Permiso para editar y ver costo y precio ")])]),i("div",{staticClass:"w-full lg:w-1/12"},[i("el-switch",{attrs:{id:"permit-can-edit-prices-"+s.id,disabled:s.isOwner},on:{change:function(i){return e.changePermit(s,"canEditOrdersPrices")}},model:{value:s.canEditOrdersPrices,callback:function(i){e.$set(s,"canEditOrdersPrices",i)},expression:"user.canEditOrdersPrices"}})],1)]),i("div",{staticClass:"w-full py-1 flex flex-col lg:flex-row"},[i("div",{staticClass:"w-full lg:w-5/12"},[i("label",{class:{"cursor-pointer":!s.isOwner},attrs:{for:"permit-can-edit-quantities-"+s.id}},[i("i",{staticClass:"bx bx-info-circle",attrs:{title:"El usuario podrÃ¡ modificar la cantidad de el inventario"}}),e._v(" Permiso para editar el stock de productos ")])]),i("div",{staticClass:"w-full lg:w-1/12"},[i("el-switch",{attrs:{id:"permit-can-edit-quantities-"+s.id,disabled:s.isOwner},on:{change:function(i){return e.changePermit(s,"canEditStockQuantities")}},model:{value:s.canEditStockQuantities,callback:function(i){e.$set(s,"canEditStockQuantities",i)},expression:"user.canEditStockQuantities"}})],1)])]),i("div",{staticClass:"w-full"},[i("div",{staticClass:"w-full",staticStyle:{"text-align":"right"}},[i("el-button",{staticClass:"el-button--primary",on:{click:e.save}},[e._v(" Guardar ")])],1)])]):e._e()])])}))],2)])])])],1)])])},a=[function(){var e=this,i=e._self._c;return i("div",{staticClass:"flex flex-row items-center py-4"},[i("h1",{staticClass:"text-lg font-bold inline-flex items-center px-3 py-3"},[i("strong",[e._v("Usuarios y Permisos")])])])}],n=s("2ef0"),r=s.n(n),c=s("0517"),l=s("9c09"),o=s("5a50"),d=s("7459"),u=s("3dd0"),f={name:"UsersAndPermissions",mixins:[c["a"]],components:{ContentCard:()=>Promise.resolve().then(s.bind(null,"3246"))},mounted(){this.loadUsers()},data(){return{sendingInvitation:!1,changingPermit:!1,changingRol:!1,details:{},users:[],accountTypes:[{value:o["a"].Owner,label:"DueÃ±o",disabled:!0},{value:o["a"].Technical,label:"TÃ©cnico",disabled:!1},{value:o["a"].Biller,label:"Recepcionista",disabled:!1}],email:void 0,accountType:o["a"].Technical,AccountTypeEnum:o["a"],errorMessage:void 0}},watch:{errorMessage:{deep:!0,handler:r.a.debounce((async function(){this.errorMessage&&(await this.$toastr.e(this.errorMessage),this.errorMessage=void 0)}),300)}},methods:{showDetails(e){this.details={...this.details,[e]:!this.details[e]}},save(){this.$toastr.s("Se actualizo con exito")},async loadUsers(){try{const e=await d["a"].UsersAndPermissions.getUsers();this.users=e.map(e=>({id:e.id,accountType:e.accountType,name:e.fullname,isOwner:e.isOwner,canViewAdministration:e.canViewAdministration||!1,canViewBranchOffices:e.canViewBranchOffices||!1,canViewStatistics:e.canViewStatistics||!1,canViewOrders:e.canViewOrders||!1,canEditOrders:e.canEditOrders||!1,canEditOrdersPrices:e.canEditOrdersPrices||!1,canEditStockQuantities:e.canEditStockQuantities||!1}))}catch(e){this.errorMessage=this.getErrorMessage(e)}},async updateUserAccountType(e,i){this.changingRol=!0;try{await d["a"].UsersAndPermissions.updateAccountType(e,{accountType:i}),this.$toastr.s("Se actualizo con exito")}catch(s){this.errorMessage=this.getErrorMessage(s)}finally{this.changingRol=!1}},async sendInvite(){this.sendingInvitation=!0;try{if(!l["a"].test(this.email))return void(this.errorMessage="Formato de correo electronico invalido");await d["a"].UsersAndPermissions.sendInvite({email:this.email.toLowerCase(),accountType:this.accountType}),this.email=void 0,this.accounType=o["a"].Technical,this.$toastr.s("Invitacion enviada con exito")}catch(e){this.errorMessage=this.getErrorMessage(e)}finally{this.sendingInvitation=!1}},async changePermit(e,i){this.changingPermit=!0;try{const s={accountId:e.id,permission:o["p"][i],value:e[i]};await d["a"].UsersAndPermissions.updatePermit(s),await this.$store.dispatch(u["e"],{...this.$store.state.account,[i]:e[i]})}catch(s){e[i]=!e[i],this.errorMessage=this.getErrorMessage(s)}finally{this.changingPermit=!1}}}},w=f,v=s("2877"),p=Object(v["a"])(w,t,a,!1,null,null,null);i["default"]=p.exports},"9c09":function(e,i,s){"use strict";s.d(i,"a",(function(){return t}));const t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/}}]);
//# sourceMappingURL=chunk-575ddda8.8afae581.js.map