(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ec70d12"],{5312:function(t,e,r){"use strict";r("ec31")},"73c5":function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var o=r("c177");class a{static async getAll(t){var e;const r=await o["a"].submit({method:"get",url:"products",parameters:t});return null!==(e=null===r||void 0===r?void 0:r.data)&&void 0!==e?e:null}static async getById(t){var e;const r=await o["a"].submit({method:"get",url:"products/"+t});return null!==(e=null===r||void 0===r?void 0:r.data)&&void 0!==e?e:null}static async create({product:t}){var e;const r=await o["a"].submit({method:"post",url:"products",data:t});return null!==(e=null===r||void 0===r?void 0:r.data)&&void 0!==e?e:null}static async update({id:t,product:e}){var r;const a=await o["a"].submit({method:"put",url:"products/"+t,data:e});return null!==(r=null===a||void 0===a?void 0:a.data)&&void 0!==r?r:null}static async delete({ids:t}){var e;const r=await o["a"].submit({method:"post",url:"products/deleteAllById",data:{ids:t}});return null!==(e=null===r||void 0===r?void 0:r.data)&&void 0!==e?e:null}static async updateQty({id:t,quantity:e}){var r;const a=await o["a"].submit({method:"put",url:"products/quantity/"+t,data:{quantity:e}});return null!==(r=null===a||void 0===a?void 0:a.data)&&void 0!==r?r:null}}},"9c25":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"space-y-2 py-4",class:{"quick-start-selected":4===t.$store.state.quickStart.step}},[e("div",{staticClass:"w-full flex justify-between"},[e("span",{staticClass:"font-bold text-md"},[t._v("Productos")]),e("a",{staticClass:"text-purple-400",on:{click:t.showCreateProductDialog}},[e("strong",[t._v("+ Agregar nuevo producto")])])]),e("div",[e("div",{staticClass:"flex flex-row space-x-2"},[e("el-input",{attrs:{type:"text"},on:{input:function(e){return t.showProductsDialog(!0)}},model:{value:t.productTextSearch,callback:function(e){t.productTextSearch=e},expression:"productTextSearch"}},[e("i",{staticClass:"mt-2 text-xl bx bx-search",attrs:{slot:"prefix"},slot:"prefix"})]),e("sa-button",{attrs:{size:"mini",type:"secondary"},on:{click:function(e){return t.showProductsDialog(!0)}}},[t._v(" Explorar ")])],1)])]),t.hasOrderDeviceProducts?e("table",{staticClass:"table-fixed py-4 border-separate"},[t._m(0),e("tbody",t._l(t.orderDevice.orderDeviceProducts,(function(r,o){var a;return e("tr",{key:"orderDeviceProducts-"+o},[e("td",{},[e("div",{staticClass:"w-full flex flex-col"},[e("strong",{staticClass:"text-sm"},[t._v(t._s((null===(a=r.productCategory)||void 0===a?void 0:a.name)||r.category))]),e("span",[t._v(t._s(r.name))])])]),e("td",[e("el-form",{ref:`product-${o}-quantity`,refInFor:!0,attrs:{model:r,rules:t.productRules}},[e("el-form-item",{attrs:{prop:"quantity"}},[e("el-input",{attrs:{type:"number",placeholder:"0"},model:{value:r.quantity,callback:function(e){t.$set(r,"quantity",e)},expression:"product.quantity"}})],1)],1)],1),e("td",[e("el-form",{ref:`product-${o}-cost`,refInFor:!0,attrs:{model:r,rules:t.productRules}},[e("el-form-item",{attrs:{prop:"cost"}},[t.$store.state.account.canEditOrdersPrices?e("el-input",{attrs:{type:"number",placeholder:"0.00"},model:{value:r.cost,callback:function(e){t.$set(r,"cost",e)},expression:"product.cost"}}):t._e(),t.$store.state.account.canEditOrdersPrices?t._e():e("el-input",{attrs:{disabled:"",placeholder:"***"}})],1)],1)],1),e("td",[t.$store.state.account.canEditOrdersPrices?e("el-input",{staticClass:"w-full el-input-text-right",attrs:{type:"number",placeholder:"0.00"},model:{value:r.price,callback:function(e){t.$set(r,"price",e)},expression:"product.price"}}):t._e(),t.$store.state.account.canEditOrdersPrices?t._e():e("el-input",{attrs:{disabled:"",placeholder:"***"}})],1),e("td",{staticClass:"text-right"},[e("sa-icon-button",{attrs:{iconClass:"bx bx-x","with-bg":""},on:{click:function(e){return t.removeProduct(o)}}})],1)])})),0)]):t._e(),e("el-dialog",{attrs:{visible:t.isVisibleSearchProductsDialog,width:t.dialogClientWidth},on:{"update:visible":function(e){t.isVisibleSearchProductsDialog=e},close:t.onCloseSearchProductsDialog}},[e("div",{staticClass:"-mx-5"},[t.isVisibleSearchProductsDialog?e("device-products-search",{attrs:{textSearch:t.productTextSearch},on:{cancel:function(e){return t.showProductsDialog(!1)},onSelectProducts:t.onSelectProducts}}):t._e()],1)]),e("el-dialog",{attrs:{visible:t.isVisibleCreateProductDialog,"append-to-body":"","show-close":"",width:t.dialogClientWidth},on:{"update:visible":function(e){t.isVisibleCreateProductDialog=e}}},[e("div",{staticClass:"w-full flex justify-between"},[e("span",{staticClass:"font-bold text-md"},[t._v("Crear Producto")]),e("el-button",{staticClass:"el-button--primary",on:{click:t.createProduct}},[t._v("Guardar")])],1),e("product-form",{attrs:{loading:t.createProductLoading,form:t.createProductForm}})],1)],1)},a=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"text-xs text-gray-400 uppercase"},[e("th",{staticClass:"w-5/12 text-left"},[e("span",[t._v("Producto")])]),e("th",{staticClass:"w-2/12 text-left"},[e("span",[t._v("Cantidad")])]),e("th",{staticClass:"w-2/12 text-right"},[e("span",{staticClass:"mr-2"},[t._v("Costo")])]),e("th",{staticClass:"w-2/12 text-right"},[e("span",{staticClass:"mr-2"},[t._v("Precio")])]),e("th",{staticClass:"w-1/12 sr-only"},[t._v(" Eliminar ")])])])}],i=(r("d9e2"),r("4081")),s=r("8266"),c=r("73c5"),d=r("0517"),l=r("2ef0"),n=r.n(l),u={name:"ProductsBlock",components:{DeviceProductsSearch:()=>r.e("chunk-2d222035").then(r.bind(null,"cd97")),ProductForm:()=>r.e("chunk-72711c8d").then(r.bind(null,"6d23"))},mixins:[s["a"],d["a"]],props:{orderDeviceIndex:{type:Number,default:()=>null}},data(){return{dialogClientWidth:"40%",productTextSearch:null,isVisibleSearchProductsDialog:!1,isVisibleCreateProductDialog:!1,createProductLoading:!1,createProductForm:{name:void 0,description:void 0,category:void 0,brand_model:void 0,cost:void 0,price:void 0,quantity:0},productRules:{quantity:[{required:!0,validator(t,e,r){(null===e||void 0===e||""===e||e<=0)&&r(new Error("La cantidad debe ser mayor a 0 para continuar"))}}],cost:[{required:!0,validator(t,e,r){(null===e||void 0===e||""===e||e<0)&&r(new Error("El costo debe ser 0 o un nÃºmero mayor para continuar"))}}]}}},created(){window.addEventListener("resize",n.a.debounce(this.resizeDialogWidth,200))},destroyed(){window.removeEventListener("resize",n.a.debounce(this.resizeDialogWidth,200))},computed:{orderDevice(){return i["e"].order.orderDevices[this.orderDeviceIndex]},hasOrderDeviceProducts(){return!!this.orderDevice.orderDeviceProducts&&this.orderDevice.orderDeviceProducts.length>0}},watch:{"orderDevice.orderDeviceProducts":{deep:!0,handler:n.a.debounce((async function(){const t=Object.keys(this.$refs);for(let e=0;e<t.length;e++){const r=this.$refs[t[e]][0];r&&r.validate().catch(()=>{})}}),300)}},methods:{removeProduct(t){i["d"].removeOrderDeviceProduct(this.orderDeviceIndex,t)},onCloseSearchProductsDialog(){this.productTextSearch=null},showProductsDialog(t){this.isVisibleSearchProductsDialog=t},showCreateProductDialog(){this.isVisibleCreateProductDialog=!0,this.resizeDialogWidth()},onSelectProducts(t){for(let e=0;e<t.length;e++){const r=t[e];i["d"].addOrderDeviceProduct(this.orderDeviceIndex,{...r,quantity:1})}this.showProductsDialog(!1)},resizeDialogWidth(){const t=this.getPercentageWidth();this.dialogClientWidth="30%"===t?"40%":t},async createProduct(){this.createProductLoading=!0;try{const t={name:this.createProductForm.name,description:this.createProductForm.description,category:this.createProductForm.category,brandModel:this.createProductForm.brand_model,cost:parseFloat(this.createProductForm.cost),price:parseFloat(this.createProductForm.price),quantity:parseFloat(this.createProductForm.quantity)},e=await c["a"].create({product:t});await this.$toastr.s("Se creo con exito"),i["d"].addOrderDeviceProduct(this.orderDeviceIndex,{...e,quantity:1})}catch(d){this.$toastr.e(this.getErrorMessage(d))}finally{this.createProductLoading=!1,this.isVisibleCreateProductDialog=!1}}}},p=u,h=(r("5312"),r("2877")),v=Object(h["a"])(p,o,a,!1,null,"9c1b39ca",null);e["default"]=v.exports},ec31:function(t,e,r){}}]);
//# sourceMappingURL=chunk-0ec70d12.8d4052b8.js.map